#include "atmfunctions.h"  

int main() {
    intro();

    int choice = 0;

    do {
        filetoarray();   
        system("cls"); 
        cout << endl;
        cout<<"************************************************************************************************************************"<<endl<< endl;
        cout << "                               ---- >>  \033[91m  ************| MAIN MENU |************\033[0m  << ---- " << endl << endl;

        cout << "\033[1;34m"  
            <<  "                                           ------------------------------------" << endl;
        cout << "                                          |   \033[96m       ATM MAIN MENU     \033[0m   \033[1;34m     |" << endl;
        cout << "                                           ------------------------------------\033[0m" << endl; //    
        cout << endl <<endl <<endl
            << "\033[1;32m"   
            << " --> PRESS 1 FOR \033[96mLOGIN\033[0m" << endl;
        cout << "\033[0m"   
            << " ------------------------------------" << endl;
        cout << endl
            << "\033[1;32m" 
            << " --> PRESS 2 FOR \033[096mPIN UPDATE\033[0m" << endl;
        cout << "\033[0m" 
            << " ------------------------------------" << endl;
        cout << endl
            << "\033[1;32m" 
            << " --> PRESS 3 FOR ACCESS TO \033[96mADMIN PANEL\033[0m" << endl;
        cout << "\033[0m"   
            << " ------------------------------------" << endl;
        cout << endl
            << "\033[1;32m"   
            << " --> PRESS 4 TO \033[91mEXIT\033[0m PROGRAM" << endl;
        cout <<"\033[0m"
            << " ------------------------------------ " << endl;
        cout << endl << endl << endl << endl << endl << endl << endl ;
        cout << "************************************************************************************************************************"<<endl;
           cin >> choice;
        while (choice < 1 || choice > 4) { 
            system("cls");
         cout << "***********************************************************************************************************************" << endl;
            cout << endl
                << "\033[1;32m"
                << " --> PRESS 1 FOR \033[96mLOGIN\033[0m" << endl;
            cout << "\033[0m"
                << " ------------------------------------" << endl;
            cout << endl
                << "\033[1;32m"
                << " --> PRESS 2 FOR \033[096mPIN UPDATE\033[0m" << endl;
            cout << "\033[0m"
                << " ------------------------------------" << endl;
            cout << endl
                << "\033[1;32m"
                << " --> PRESS 3 FOR ACCESS TO \033[96mADMIN PANEL\033[0m" << endl;
            cout << "\033[0m"
                << " ------------------------------------" << endl;
            cout << endl
                << "\033[1;32m"
                << " --> PRESS 4 TO \033[91mEXIT\033[0m PROGRAM" << endl;
            cout << "\033[0m"
                << " ------------------------------------ " << endl;
            cout << endl << endl << endl << endl << endl << endl << endl;
            cout << "************************************************************************************************************************" << endl;
            cin >> choice;
        }

        if (choice == 1) {
            system("cls");
            int index = login();
            if (index >= 0) {
                int x;
                do {
                    system("cls");
                    cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                    cout << endl << endl<< endl;
                    cout << "                              Choose any of the following actions from the ATM you want to perform: ";
                    cout << "\033[1;34m"  
                         << "                                  ----------------------------------------" << endl;
                    cout << "                                 |            \033[95m LOGIN PANEL \033[0m                |" << endl;
                    cout << "                                  ----------------------------------------\033[0m" << endl;
                    cout << endl << endl
                                                                      
                        << "\033[1;32m *)  PRESS 1 TO \033[93mWITHDRAW\033[0m\033[0m                                 \033[1;32m *) PRESS 2 TO \033[93mDEPOSIT\033[0m\033[0m" << endl
                        << "-----------------------------------------                 -----------------------------------------" ;                      
                    cout << endl <<endl;
                      
                    cout << endl
                        << "\033[1;32m *)  PRESS 3 FOR \033[93mFUNDS TRANSFER\033[0m\033[0m                         \033[1;32m *)  PRESS 4 FOR \033[93mMINI STATEMENT\033[0m\033[0m" << endl
                        << "----------------------------------------                  ----------------------------------------" ;
                    cout << endl;
                    cout << endl<< endl
                        
                        << "\033[1;32m *)  PRESS 5 FOR \033[93mBALANCE INQUIRY\033[0m \033[0m                        \033[1;32m *)  PRESS 6 TO \033[33mEXIT\033[0m PROGRAM\033[0m" << endl
                        << "----------------------------------------                  ----------------------------------------" ;
                    cout << endl
                     << endl;
                    cout << endl;
                    cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;

                    cin >> x;

                    switch (x) {
                    case 1:

                        system("cls");
                        cout <<endl<< "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        withdraw(index);
                        cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        break;

                    case 2:

                        system("cls");
                        cout <<endl<< "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        deposit(index);
                        cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        break;

                    case 3:

                        system("cls");
                        cout <<endl<< "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        fundstransfer(index);
                        cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        break;

                    case 4:

                        system("cls");
                        cout <<endl<< "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        transactionhistory(index);
                        cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        break;

                    case 5:

                        system("cls");
                        cout <<endl<< "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        checkbalance(index);
                        cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        break;

                    case 6:

                        system("cls");
                        cout <<endl<< "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        cout << "\033[1;33m"
                            << "********************** \033[34m THANK YOU FOR USING ATM. HAVE A GOOD DAY \033[0m *********************" << endl
                            << "\033[0m";
                        cout << "\033[90m*********************************************************************************************************************\033[0m" << endl;
                        break;

                    default:
                        cout << " \033[31m INVALID CHOICE \033[0m..... \033[36m Please try Again \033[0m" << endl;
                    }

                    if (x != 6)
                    {
                        cout << endl << endl;
                        cout << "\033[93mTo perform Another Operation PRESS ?\033[0m  (\"\033[91m 1 \033[0m\" for \"\033[93m YES \033[0m\" and \"\033[91m 0 \033[0m\" for \"\033[93m NO \033[0m\")" << endl;
                        int y = 0;
                        cin >> y;

                        while (y < 0 || y > 1) {   
                            cout << " \033[31m INVALID CHOICE \033[0m..... \033[36m Please try Again \033[0m" << endl;
                            sound();
                            cin >> y;
                        }
                        if (y == 0) {
                            cout << "********************** \033[34m THANK YOU FOR USING ATM. HAVE A GOOD DAY \033[0m *********************" << endl;
                                break;
                        }
                    }
                } while (x != 6);
            }
        }
        else if (choice == 2) {
            system("cls");
            updatepin();
        }
        else if (choice == 3) {
            system("cls");
            adminpanel();
        }
        else if (choice == 4) {
            system("cls");
            cout << "\033[1;33m" 
                << "********************** \033[34m THANK YOU FOR USING ATM. HAVE A GOOD DAY \033[0m *********************" << endl
                << "\033[0m";
            break;
        }

        if (choice != 4) {
            cout << endl;
            cout << "\033[1;34m" 
                << "********************** -->>  WELCOME BACK TO MAIN MENU <<-- *******************************" << endl
                << "\033[0m"; 
            cout << endl;
            cout << "\033[93mTo perform Another Operation PRESS ?\033[0m  (\"\033[91m 1 \033[0m\" for \"\033[93m YES \033[0m\" and \"\033[91m 0 \033[0m\" for \"\033[93m NO \033[0m\")" << endl;
            cin >> choice;

            while (choice < 0 || choice > 1) { 
                cout << "INVALID CHOICE. PLEASE TRY AGAIN" << endl;
                sound();
                cin >> choice;
            }

            if (choice == 0) {
                cout << "********************** \033[34m THANK YOU FOR USING ATM. HAVE A GOOD DAY \033[0m *********************" << endl;
                    break;
            }
        }

    } while (choice != 4);
}